<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Widget de Calendario - OmniERP</title>
    <link rel="stylesheet" href="/static/global.css">
    <link rel="stylesheet" href="/static/components.css">
    <link rel="stylesheet" href="/static/aaaaa-animations.css">
    <link rel="stylesheet" href="/static/assistant.css">
    <style>
        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .demo-header {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .demo-header h1 {
            color: #667eea;
            margin-bottom: 1rem;
        }
        .demo-header p {
            color: #666;
            margin-bottom: 0.5rem;
        }
        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }
        .demo-section {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .demo-section h2 {
            color: #333;
            margin-bottom: 1rem;
        }
        .demo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }
        .widget-preview {
            border: 2px dashed #e0e0e0;
            padding: 2rem;
            border-radius: 8px;
            min-height: 200px;
            background: #fafafa;
        }
    </style>
    <link rel="stylesheet" href="/static/modules-base.css">
    <link rel="stylesheet" href="/static/components-advanced.css">
</head>
<body>
    <div class="demo-container">
        <div class="demo-header">
            <h1>üìÖ Widget de Calendario Embebible</h1>
            <p>Permite a tus clientes programar citas directamente desde tu sitio web</p>
            <p><strong>URL del Widget:</strong> <code id="widgetUrl"></code></p>
        </div>

        <div class="demo-section">
            <h2>üìã Instrucciones de instalaci√≥n</h2>
            <p>Copia y pega este c√≥digo en tu sitio web donde quieras que aparezca el widget:</p>

            <div class="code-block" id="embedCode"></div>

            <button onclick="copiarCodigo()" style="
                background: #667eea;
                color: white;
                border: none;
                padding: 0.8rem 1.5rem;
                border-radius: 8px;
                cursor: pointer;
                font-weight: 600;
                margin-top: 1rem;
            ">üìã Copiar c√≥digo</button>
        </div>

        <div class="demo-section">
            <h2>üëÅÔ∏è Vista previa</h2>
            <div class="widget-preview" id="widgetPreview">
                <!-- El widget se cargar√° aqu√≠ -->
            </div>
        </div>

        <div class="demo-section">
            <h2>‚öôÔ∏è Personalizaci√≥n</h2>
            <div class="demo-grid">
                <div>
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Color del tema:</label>
                    <input type="color" id="themeColor" value="#667eea" onchange="actualizarWidget()" style="width: 100%; height: 50px; border: none; border-radius: 8px; cursor: pointer;">
                </div>
                <div>
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">T√≠tulo del widget:</label>
                    <input type="text" id="widgetTitle" value="Reserva tu cita" onchange="actualizarWidget()" style="width: 100%; padding: 0.7rem; border: 2px solid var(--gray-300); border-radius: 8px;">
                </div>
                <div>
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Duraci√≥n por defecto (min):</label>
                    <select id="duracion" onchange="actualizarWidget()" style="width: 100%; padding: 0.7rem; border: 2px solid var(--gray-300); border-radius: 8px;">
                        <option value="15">15 minutos</option>
                        <option value="30" selected>30 minutos</option>
                        <option value="45">45 minutos</option>
                        <option value="60">60 minutos</option>
                        <option value="90">90 minutos</option>
                        <option value="120">2 horas</option>
                    </select>
                </div>
                <div>
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Tipo de evento:</label>
                    <select id="tipoEvento" onchange="actualizarWidget()" style="width: 100%; padding: 0.7rem; border: 2px solid var(--gray-300); border-radius: 8px;">
                        <option value="reunion">Reuni√≥n</option>
                        <option value="cita">Cita</option>
                        <option value="consulta">Consulta</option>
                        <option value="demo">Demo</option>
                    </select>
                </div>
            </div>
        </div>
    </div>

    <script>
        const baseUrl = window.location.origin;
        const orgId = new URLSearchParams(window.location.search).get('org') || '1';

        function generarCodigoEmbed() {
            const color = document.getElementById('themeColor')?.value || '#667eea';
            const titulo = document.getElementById('widgetTitle')?.value || 'Reserva tu cita';
            const duracion = document.getElementById('duracion')?.value || '30';
            const tipo = document.getElementById('tipoEvento')?.value || 'reunion';

            return `<!-- Widget de Calendario OmniERP -->
<div id="erp-calendar-widget"></div>
<script>
  (function() {
    var widget = document.createElement('iframe');
    widget.src = '${baseUrl}/widget/calendario?org=${orgId}&color=${encodeURIComponent(color)}&titulo=${encodeURIComponent(titulo)}&duracion=${duracion}&tipo=${tipo}';
    widget.style.width = '100%';
    widget.style.height = '600px';
    widget.style.border = 'none';
    widget.style.borderRadius = '12px';
    widget.style.boxShadow = '0 4px 12px rgba(0,0,0,0.1)';
    document.getElementById('erp-calendar-widget').appendChild(widget);
  })();
<\/script>`;
        }

        function actualizarWidget() {
            const codigo = generarCodigoEmbed();
            document.getElementById('embedCode').textContent = codigo;

            const color = document.getElementById('themeColor').value;
            const titulo = document.getElementById('widgetTitle').value;
            const duracion = document.getElementById('duracion').value;
            const tipo = document.getElementById('tipoEvento').value;

            const preview = document.getElementById('widgetPreview');
            preview.innerHTML = `<iframe
                src="${baseUrl}/widget/calendario?org=${orgId}&color=${encodeURIComponent(color)}&titulo=${encodeURIComponent(titulo)}&duracion=${duracion}&tipo=${tipo}"
                style="width: 100%; height: 500px; border: none; border-radius: 8px;"
            ></iframe>`;
        }

        function copiarCodigo() {
            const codigo = document.getElementById('embedCode').textContent;
            navigator.clipboard.writeText(codigo).then(() => {
                alert('‚úÖ C√≥digo copiado al portapapeles');
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('widgetUrl').textContent = `${baseUrl}/widget/calendario-demo`;
            actualizarWidget();
        });
    </script>
</body>
</html>
